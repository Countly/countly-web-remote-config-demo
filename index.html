<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Countly Remote Config Demo</title>
    <link rel="stylesheet" href="output.css">
</head>

<body>
    <div class="w-full shadow p-2 flex flex-col md:flex-row justify-between flex-wrap">
        <img src="countly-logo.svg" width="100" alt="countly">
    
    </div>
    <div class="mx-auto">

           <div class="flex flex-col p-2" style="background: #00BB47">
               <h2 class="text-2xl m-2 text-white">Business Unit Management Panel</h2>
               <div class="flex flex-row flex-wrap w-full" >
                    <div onclick="changeUserProfile('TR','pro','false',this)" class="option w-1/6 border border-gray-400 hover:border-green-400 bg-white rounded-b p-4 m-2 leading-normal cursor-pointer">
                        <div class="flex flex-col">
                            <strong class="text-xl">Scenario 1</strong>
                            <span class="text-gray-800 text-base"><strong>Country : </strong>TR</span>
                            <span class="text-gray-800 text-base"><strong>User Plan : </strong>Pro</span>
                            <span class="text-gray-800 text-base"><strong>User Type : </strong>Regular</span>
                        </div>
                        <div class="mt-3">
                            <strong class="text-xl">Actions : </strong>
                            <ul>
                                <li class="text-gray-800 text-base"><strong>Form : </strong>show</li>
                                <li class="text-gray-800 text-base"><strong>Button background : </strong> <span class="text-blue-800">blue</span></li>
                                <li class="text-gray-800 text-base"><strong>Campaign : </strong> Biggest sale</li>
                            </ul>
                        </div>
                    </div>
                    <div onclick="changeUserProfile('US','pro','false',this)" class="option w-1/6 border border-gray-400 hover:border-green-400 bg-white rounded-b p-4 m-2 leading-normal cursor-pointer">
                        <div class="flex flex-col">
                            <strong class="text-xl">Scenario 2</strong>
                            <span class="text-gray-800 text-base"><strong>Country : </strong>US</span>
                            <span class="text-gray-800 text-base"><strong>User Plan : </strong>Pro</span>
                            <span class="text-gray-800 text-base"><strong>User Type : </strong>Regular</span>
                        </div>
                        <div class="mt-3">
                            <strong class="text-xl">Actions : </strong>
                            <ul>
                                <li class="text-gray-800 text-base"><strong>Form : </strong>hide</li>
                                <li class="text-gray-800 text-base"><strong>Button background : </strong> <span class="text-red-800">red</span></li>
                                <li class="text-gray-800 text-base"><strong>Campaign : </strong> Biggest sale</li>
                            </ul>
                        </div>
                    </div>
                    <div onclick="changeUserProfile('US','pro','true',this)" class="option w-1/6 border border-gray-400 hover:border-green-400 bg-white rounded-b p-4 m-2 leading-normal cursor-pointer">
                        <div class="flex flex-col">
                            <strong class="text-xl">Scenario 3</strong>
                            <span class="text-gray-800 text-base"><strong>Country : </strong>US</span>
                            <span class="text-gray-800 text-base"><strong>User Plan : </strong>Pro</span>
                            <span class="text-gray-800 text-base"><strong>User Type : </strong>Test User</span>
                        </div>
                        <div class="mt-3">
                            <strong class="text-xl">Actions : </strong>
                            <ul>
                                <li class="text-gray-800 text-base"><strong>Form : </strong>hide</li>
                                <li class="text-gray-800 text-base"><strong>Button background : </strong> <span class="text-green-800">green</span></li>
                                <li class="text-gray-800 text-base"><strong>Campaign : </strong> Biggest sale</li>
                            </ul>
                        </div>
                    </div>
                    <div onclick="changeUserProfile('TR','regular','true',this)" class="option w-1/6 border border-gray-400 hover:border-green-400 bg-white rounded-b p-4 m-2 leading-normal cursor-pointer">
                        <div class="flex flex-col">
                            <strong class="text-xl">Scenario 4</strong>
                            <span class="text-gray-800 text-base"><strong>Country : </strong>TR</span>
                            <span class="text-gray-800 text-base"><strong>User Plan : </strong>Regular</span>
                            <span class="text-gray-800 text-base"><strong>User Type : </strong>Test User</span>
                        </div>
                        <div class="mt-3">
                            <strong class="text-xl">Actions : </strong>
                            <ul>
                                <li class="text-gray-800 text-base"><strong>Form : </strong>show</li>
                                <li class="text-gray-800 text-base"><strong>Button background : </strong> <span class="text-pink-800">ping</span></li>
                                <li class="text-gray-800 text-base"><strong>Campaign : </strong> Saturday sale</li>
                            </ul>
                        </div>
                    </div>
                    <div onclick="changeUserProfile('DE','basic','false',this)" class="option w-1/6 border border-gray-400 hover:border-green-400 bg-white rounded-b p-4 m-2 leading-normal cursor-pointer">
                        <div class="flex flex-col">
                            <strong class="text-xl">Scenario 5</strong>
                            <span class="text-gray-800 text-base"><strong>Country : </strong>DE</span>
                            <span class="text-gray-800 text-base"><strong>User Plan : </strong>Basic</span>
                            <span class="text-gray-800 text-base"><strong>User Type : </strong>Regular</span>
                        </div>
                        <div class="mt-3">
                            <strong class="text-xl">Actions : </strong>
                            <ul>
                                <li class="text-gray-800 text-base"><strong>Form : </strong>hide</li>
                                <li class="text-gray-800 text-base"><strong>Button background : </strong> black</li>
                                <li class="text-gray-800 text-base"><strong>Campaign : </strong> Saturday sale</li>
                            </ul>
                        </div>
                    </div>
                
               </div>
                
           </div>



          


           

        <hr class="my-4">
        <div class="flex flex-row flex-wrap w-full">
            <div class="md:w-1/2 p-4">
                <img id="campaign" class="img-fluid" />
            </div>
            <div class="md:w-1/2 p-4">
                <h1 class="text-3xl" id="MainTitle">Main Title</h1>
                <span>Please complete your profile.</span>
                <form class="p-5" id="form">
                    <div class="mb-4">

                        <input
                            class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                            id="sport" type="text" placeholder="Your favorite sport">
                    </div>
                    <div class="mb-6">

                        <input
                            class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline"
                            id="movie" type="text" placeholder="Your favorite movie">
                    </div>
                    <div class="flex items-center justify-between">
                        <button class="shadow font-bold py-2 px-4 rounded text-white bg-red-500" type="button" id="CTAButton">
                            Save
                        </button>

                    </div>
                </form>
            </div>
        </div>
    </div>



    <script type='text/javascript'>

        //some default pre init
        var Countly = Countly || {};
        Countly.q = Countly.q || [];
        var appKey = "c2ae3fa480b274ad7b2a37587ed0639f1cd74e58";
        var apiKey = "fbade55547a5e56d70981dda8966afc5";
        var app_id = "5e58fe03b6e57432c373ad80";
        //provide countly initialization parameters
        Countly.app_key = appKey
        Countly.url = 'https://demo.count.ly/';
        Countly.app_version = "1.0.0";
        Countly.debug = true;
        Countly.remote_config = true;
        Countly.interval = 100
        Countly.q.push(['track_sessions']);


        Countly.remote_config = function(err, remoteConfigs){
        if (!err) {

                document.getElementById("MainTitle").innerText = remoteConfigs.MainTitle
                if(remoteConfigs.Form === "hide"){
                    document.getElementById("form").innerHTML = '<div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert">Form hided</div>';
                }else{
                    document.getElementById("form").innerHTML = '<div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert">Form hided</div>';
                    document.getElementById("CTAButton").style.backgroundColor = remoteConfigs.CTAButtonColor
                }
                if(remoteConfigs.campaign === 0){
                    document.getElementById("campaign").src = "campaign1.jpg";
                }else{
                    document.getElementById("campaign").src = "campaign2.jpg";
                }
        }
    };


    function getByKey(key,data) {
    var found = null;

    for (var i = 0; i < data.length; i++) {
        var element = data[i];

        if (element.parameter_key == key) {
           found = element;
       } 
    }

    return found;
}

        

        function changeUserProfile(country,plan,type,e){
            const options = document.getElementsByClassName('option')
            for(let i = 0 ; i < options.length ; i++){
                options[i].classList.remove("border-green-400");
            }
            e.classList.add("border-green-400");
            // change user plan
            Countly.q.push(['userData.set', "plan", plan]) //set custom property
            // change user type
            Countly.q.push(['userData.set', "isTestUser", type]) //set custom property
            // change user country
            Countly.country_code = country
            Countly.q.push(['userData.save']) //send userData to server
            
            setTimeout(function(){

            Countly.fetch_remote_config(function(err, remoteConfigs){
                if (!err) {
                    document.getElementById("MainTitle").innerText = remoteConfigs.MainTitle
                    if(remoteConfigs.Form === "hide"){
                    document.getElementById("form").innerHTML = '<div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert">Form hided</div>';
                }else{
                    document.getElementById("form").innerHTML = '<div class="mb-4"> <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="sport" type="text" placeholder="Your favorite sport"> </div> <div class="mb-6"> <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline" id="movie" type="text" placeholder="Your favorite movie"> </div> <div class="flex items-center justify-between"> <button class="shadow font-bold py-2 px-4 rounded text-white bg-red-500" type="button" id="CTAButton"> Save </button> </div>';
                    document.getElementById("CTAButton").style.backgroundColor = remoteConfigs.CTAButtonColor

                }

                if(remoteConfigs.campaign === 0){
                    document.getElementById("campaign").src = "campaign1.jpg";
                }else{
                    document.getElementById("campaign").src = "campaign2.jpg";
                }
               
                }

            })  

            },1500)
                
        }



        //load countly script asynchronously
        (function() {
            var cly = document.createElement('script'); cly.type = 'text/javascript';
            cly.async = true;
            //enter url of script here
            cly.src = 'https://demo.count.ly/sdk/web/countly.min.js';
            cly.onload = function(){Countly.init()};
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(cly, s);
        })();

    </script>
</body>

</html>